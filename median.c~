#include<stdio.h>
#include<stdlib.h>
int *heapify(int *a,int n)
{
  int i=n;
  while(i>0)
    {
      if(a[i]<a[i/2])
	{
	  int temp=a[i];
	  a[i]=a[i/2];
	  a[i/2] =temp;
	}
      i=i/2;
    }
  return a;
}
int delete_min(int *a,int *n) //assume a is a min heap
{
  int x=a[0];
  int temp=a[0];
  a[0]=a[*n];
  a[*n]=temp;
  *n--; //size reduces
  heapify(a,n);
}

int insert(int *a,int n,int x)
{
  if(n>=99)
    {
      printf("No insertion");
      return -1;
    }
  else
    {
      a[n+1]=x;
      n++;
      a=heapify(a,n);
      return 1;
    }
}

void print_array(int *a,int n)
{
  for(i=0;i<n;i++)
    printf("%d\n",a[i]);
}
int main()
{
  int n,i,x,eff_median,*max_heap,*min_heap,max_heap_size=0,min_heap_size=0;
  max_heap=(int *)malloc(sizeof(int)*n);
  min_heap=(int *)malloc(sizeof(int)*n);

  //eff_median is th effective median at each step
  //max_heap is the heap containing elements less than or equal to eff_median
  //min_heap is the heap containing elements greater than eff_median
  printf("Enter the number of elements : ");
  scanf("%d",&n);
  for(i=1;i<=n;i++)
    {
      printf("Enter the data  : ");
      scanf("%d",&x);
      if(i==0) //the first time
	{
	  eff_median=x;
	  insert(max_heap,max_heap_size,x); //insert into heap
	  max_heap_size++;
	  printf("\nThe median is %d\n",eff_median);
	  continue;
	}
      else
	{
	  //atleast one heaps is non empty
	  if(x<=eff_median)
	    insert(max_heap,max_heap_size,x);
	  else
	    insert(min_heap,min_heap_size,x);
	  balance_heap(max_heap,max_heap_size,min_heap,min_heap_size);
	}
      if(i%2==0) //the number of elements are even
	{
	  eff_median=(max_heap[0]+min_heap[0])/2;
	  printf("\nThe median is %d\n",(max_heap[0]+min_heap[0])/2);
	}
      else //odd number of elements 
	{
	  //median is the eff_median
	  printf("\nThe median is %d\n",eff_median);
	}

    }
  print_array(max_heap,max_heap_size);
  return 0;
}
